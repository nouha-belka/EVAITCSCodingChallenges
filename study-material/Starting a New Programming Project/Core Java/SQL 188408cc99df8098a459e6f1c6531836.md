# SQL

# Comprehensive Guide to SQL (MySQL)

SQL (Structured Query Language) is the standard language for managing and manipulating relational databases. This guide will cover fundamental to advanced concepts with detailed explanations of each topic.

## 1. Database Fundamentals

Before we dive into complex topics, it's essential to understand how to create and manage databases.

### Creating and Managing Databases

Let's break down the basic commands for database creation and management:

```sql
-- Create a database
CREATE DATABASE company_db;

-- Use the database
USE company_db;

-- Create a table
CREATE TABLE employees (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100),
    department VARCHAR(50),
    salary DECIMAL(10,2),
    hire_date DATE
);
```

Let's understand each part of this code:

- **CREATE DATABASE:** This command creates a new database. The name 'company_db' should be meaningful and relate to your project.
- **USE:** This command tells MySQL which database you want to work with. You must execute this before performing operations on tables.
- **CREATE TABLE:** This defines the structure of your table:
- `id INT PRIMARY KEY AUTO_INCREMENT`: Creates a unique identifier that automatically increases
- `VARCHAR(100)`: String field with maximum length of 100 characters
- `DECIMAL(10,2)`: Number with 10 total digits, 2 after decimal point

### Basic CRUD Operations (Create, Read, Update, Delete)

These are the fundamental operations you'll perform on databases:

```sql
-- Insert data (Create)
INSERT INTO employees (name, department, salary, hire_date)
VALUES ('John Doe', 'IT', 75000.00, '2024-01-15');

-- Select data (Read)
SELECT * FROM employees WHERE department = 'IT';

-- Update data
UPDATE employees SET salary = 80000.00 WHERE id = 1;

-- Delete data
DELETE FROM employees WHERE id = 1;
```

Understanding each operation:

- **INSERT:** Adds new records to the table. You specify the columns in parentheses and their corresponding values.
- **SELECT:** Retrieves data from the table. The asterisk (*) means "all columns". The WHERE clause filters the results.
- **UPDATE:** Modifies existing records. Always use a WHERE clause to specify which records to update.
- **DELETE:** Removes records from the table. Again, the WHERE clause is crucial to avoid deleting unintended records.

## 2. Stored Procedures

Stored procedures are pre-compiled SQL statements that can be saved and reused. They can accept parameters and perform complex operations.

```sql
DELIMITER //

CREATE PROCEDURE InsertEmployee(
    IN p_name VARCHAR(100),
    IN p_department VARCHAR(50),
    IN p_salary DECIMAL(10,2),
    OUT p_status VARCHAR(100)
)
BEGIN
    DECLARE EXIT HANDLER FOR SQLEXCEPTION
    BEGIN
        SET p_status = 'Error occurred';
        ROLLBACK;
    END;

    START TRANSACTION;
        INSERT INTO employees(name, department, salary, hire_date)
        VALUES(p_name, p_department, p_salary, CURDATE());
        SET p_status = 'Employee added successfully';
    COMMIT;
END //

DELIMITER ;
```

Let's break down this stored procedure:

- **DELIMITER //**: Changes the delimiter temporarily to allow multiple statements in the procedure
- **IN parameters:** Values passed into the procedure (p_name, p_department, p_salary)
- **OUT parameters:** Values returned by the procedure (p_status)
- **DECLARE EXIT HANDLER:** Error handling mechanism that catches SQL exceptions
- **START TRANSACTION:** Ensures data integrity by making the operation atomic

## 3. Functions

Functions are similar to stored procedures but must return a value. They're useful for calculations and data transformations.

```sql
DELIMITER //

CREATE FUNCTION CalculateTotalSalary(
    base_salary DECIMAL(10,2),
    bonus_percent INT
)
RETURNS DECIMAL(10,2)
DETERMINISTIC
BEGIN
    DECLARE total_salary DECIMAL(10,2);
    SET total_salary = base_salary + (base_salary * bonus_percent / 100);
    RETURN total_salary;
END //

DELIMITER ;
```

Key components of functions:

- **RETURNS:** Specifies the data type that the function will return
- **DETERMINISTIC:** Indicates that the function will always return the same result for the same input
- **DECLARE:** Creates local variables within the function
- **SET:** Assigns values to variables

## 4. Triggers

Triggers are special procedures that automatically execute when specific events occur on a table.

```sql
DELIMITER //

CREATE TRIGGER before_salary_update
BEFORE UPDATE ON employees
FOR EACH ROW
BEGIN
    IF NEW.salary < OLD.salary THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Salary cannot be reduced';
    END IF;
    
    -- Log the salary change
    INSERT INTO salary_audit_log(
        employee_id,
        old_salary,
        new_salary,
        change_date
    )
    VALUES(
        NEW.id,
        OLD.salary,
        NEW.salary,
        NOW()
    );
END //

DELIMITER ;
```

Understanding trigger components:

- **BEFORE/AFTER:** Determines when the trigger executes relative to the main operation
- **FOR EACH ROW:** The trigger executes once for each affected row
- **NEW/OLD:** Special references to the row data:
- OLD: Contains the original values before the update
- NEW: Contains the new values being set

## 5. Best Practices and Tips for Students

- **Always backup your database** before making significant changes
- **Use meaningful names** for databases, tables, procedures, and variables
- **Comment your code** to explain complex logic or business rules
- **Test thoroughly** with different scenarios and edge cases
- **Use transactions** when multiple operations need to be atomic
- **Implement proper error handling** to make your code robust

Remember: The best way to learn SQL is through practice. Try modifying the example code and observe the results. Create your own databases and experiment with different scenarios.

[Advanced SQL Concepts: A Deeper Dive](SQL/Advanced%20SQL%20Concepts%20A%20Deeper%20Dive%20190408cc99df80b1b5ade3610b52cee8.md)

[SQL Aggregate Functions and Essential Features: A Deep Dive](SQL/SQL%20Aggregate%20Functions%20and%20Essential%20Features%20A%20D%20190408cc99df8079b5ffca2487517eb2.md)

[MongoDB (NoSQL)](SQL/MongoDB%20(NoSQL)%201c8408cc99df8009889de04b508e6737.md)